"use strict";(self.webpackChunknewdocs=self.webpackChunknewdocs||[]).push([[3802],{28930:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>i,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var s=n(85893),t=n(11151);const r={sidebar_position:7},d="Datalayer",o={id:"docs/fundamentals/datalayer_overview",title:"Datalayer",description:"The abstraction coordinates models, data and backends is the superduperdb.base.datalayer.Datalayer class.",source:"@site/content/docs/fundamentals/07_datalayer_overview.md",sourceDirName:"docs/fundamentals",slug:"/docs/fundamentals/datalayer_overview",permalink:"/docs/docs/fundamentals/datalayer_overview",draft:!1,unlisted:!1,editUrl:"https://github.com/SuperDuperDB/superduperdb/tree/main/docs/content/docs/fundamentals/07_datalayer_overview.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Connect your database",permalink:"/docs/docs/fundamentals/connecting"},next:{title:"Component Abstraction",permalink:"/docs/docs/fundamentals/component_abstraction"}},i={},c=[{value:"Data-backend",id:"data-backend",level:3},{value:"Artifact Store",id:"artifact-store",level:3},{value:"Metadata Store",id:"metadata-store",level:3},{value:"Default settings",id:"default-settings",level:2}];function l(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.h1,{id:"datalayer",children:"Datalayer"}),"\n",(0,s.jsxs)(a.p,{children:["The abstraction coordinates models, data and backends is the ",(0,s.jsx)(a.code,{children:"superduperdb.base.datalayer.Datalayer"})," class."]}),"\n",(0,s.jsxs)(a.p,{children:["The ",(0,s.jsx)(a.code,{children:"Datalayer"}),' is a highly configurable class which "wires together" three important backends involved in the AI workflow:']}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["Querying the database via the ",(0,s.jsx)(a.strong,{children:"databackend"})]}),"\n",(0,s.jsxs)(a.li,{children:["Storing and retrieving serialized model-weights and other artifacts from the ",(0,s.jsx)(a.strong,{children:"artifact store"})]}),"\n",(0,s.jsxs)(a.li,{children:["Storing and retrieval important meta-data, from the ",(0,s.jsx)(a.strong,{children:"meta-data store"})," and information about models and other components which are to be installed with ",(0,s.jsx)(a.code,{children:"superduperdb"})]}),"\n"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"from superduperdb import superduper\n\ndb = superduper()\n\ndb.databackend\n# <superduperdb.backends.mongodb.data_backend.MongoDataBackend at 0x1562815d0>\n\ndb.artifact_store\n# <superduperdb.backends.mongodb.artifacts.MongoArtifactStore at 0x156869f50>\n\ndb.metadata\n# <superduperdb.backends.mongodb.metadata.MongoMetaDataStore at 0x156866a10>\n"})}),"\n",(0,s.jsxs)(a.p,{children:["Our aim is to make it easy to set-up each aspect of the ",(0,s.jsx)(a.code,{children:"Datalayer"})," with your preferred\ndatabases."]}),"\n",(0,s.jsx)(a.h3,{id:"data-backend",children:"Data-backend"}),"\n",(0,s.jsxs)(a.p,{children:["The databackend typically connects to your database (although ",(0,s.jsx)(a.code,{children:"superduperdb"})," also supports other databackends such as a directory of ",(0,s.jsx)(a.code,{children:"pandas"})," dataframes),\nand dispatches queries written in an query API which is compatible with that databackend, but which also includes additional aspects\nspecific to ",(0,s.jsx)(a.code,{children:"superduperdb"}),"."]}),"\n",(0,s.jsxs)(a.p,{children:["Read more ",(0,s.jsx)(a.a,{href:"/docs/docs/walkthrough/supported_query_APIs",children:"here"}),"."]}),"\n",(0,s.jsxs)(a.p,{children:["The databackend is configured by setting the URI ",(0,s.jsx)(a.code,{children:"CFG.databackend"})," in the ",(0,s.jsx)(a.a,{href:"/docs/docs/walkthrough/configuration",children:"configuration system"}),"."]}),"\n",(0,s.jsxs)(a.p,{children:["We support the same databackends as supported by the ",(0,s.jsxs)(a.a,{href:"https://ibis-project.org/",children:[(0,s.jsx)(a.code,{children:"ibis"})," project"]}),":"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.mongodb.com/",children:(0,s.jsx)(a.strong,{children:"MongoDB"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.postgresql.org/",children:(0,s.jsx)(a.strong,{children:"PostgreSQL"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.sqlite.org/index.html",children:(0,s.jsx)(a.strong,{children:"SQLite"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://duckdb.org/",children:(0,s.jsx)(a.strong,{children:"DuckDB"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://cloud.google.com/bigquery",children:(0,s.jsx)(a.strong,{children:"BigQuery"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://clickhouse.com/",children:(0,s.jsx)(a.strong,{children:"ClickHouse"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://arrow.apache.org/datafusion/",children:(0,s.jsx)(a.strong,{children:"DataFusion"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://druid.apache.org/",children:(0,s.jsx)(a.strong,{children:"Druid"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://impala.apache.org/",children:(0,s.jsx)(a.strong,{children:"Impala"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.microsoft.com/en-us/sql-server/",children:(0,s.jsx)(a.strong,{children:"MSSQL"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.mysql.com/",children:(0,s.jsx)(a.strong,{children:"MySQL"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.oracle.com/database/",children:(0,s.jsx)(a.strong,{children:"Oracle"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://pandas.pydata.org/",children:(0,s.jsx)(a.strong,{children:"pandas"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.pola.rs/",children:(0,s.jsx)(a.strong,{children:"Polars"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://spark.apache.org/docs/3.3.1/api/python/index.html",children:(0,s.jsx)(a.strong,{children:"PySpark"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.snowflake.com/en/",children:(0,s.jsx)(a.strong,{children:"Snowflake"})})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://trino.io/",children:(0,s.jsx)(a.strong,{children:"Trino"})})}),"\n"]}),"\n",(0,s.jsx)(a.h3,{id:"artifact-store",children:"Artifact Store"}),"\n",(0,s.jsxs)(a.p,{children:["The artifact-store is the place where large pieces of data associated with your AI models are saved.\nUsers have the possibility to configure either a local filesystem, or an artifact store on MongoDB ",(0,s.jsx)(a.code,{children:"gridfs"}),":"]}),"\n",(0,s.jsx)(a.p,{children:"For example:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"CFG.artifact_store = 'mongodb://localhost:27017/documents'\n"})}),"\n",(0,s.jsx)(a.p,{children:"Or:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"CFG.artifact_store = 'filesystem://./data'\n"})}),"\n",(0,s.jsx)(a.h3,{id:"metadata-store",children:"Metadata Store"}),"\n",(0,s.jsx)(a.p,{children:"The meta-data store is the place where important information associated with models and\nrelated components are kept:"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Where are the data artifacts saved for a component?"}),"\n",(0,s.jsx)(a.li,{children:"Important parameters necessary for using a component"}),"\n",(0,s.jsx)(a.li,{children:"Important parameters which were used to create a component (e.g. in training or otherwise)"}),"\n"]}),"\n",(0,s.jsx)(a.p,{children:"Similarly to the databackend and artifact store, the metadata store is configurable:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"CFG.metadata = 'mongodb://localhost:27017/documents'\n"})}),"\n",(0,s.jsx)(a.p,{children:"We support metadata store via:"}),"\n",(0,s.jsxs)(a.ol,{children:["\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.mongodb.com/",children:"MongoDB"})}),"\n",(0,s.jsxs)(a.li,{children:["All databases supported by ",(0,s.jsx)(a.a,{href:"https://www.sqlalchemy.org/",children:"SQLAlchemy"}),".\nFor example, these databases supported by the databackend are also supported by the metadata store.","\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.postgresql.org/",children:"PostgreSQL"})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.mysql.com/",children:"MySQL"})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.sqlite.org/",children:"SQLite"})}),"\n",(0,s.jsx)(a.li,{children:(0,s.jsx)(a.a,{href:"https://www.microsoft.com/en-us/sql-server/sql-server-downloads",children:"MSSQL"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(a.h2,{id:"default-settings",children:"Default settings"}),"\n",(0,s.jsx)(a.p,{children:"In such cases, the default configuration is to use the same configuration as used in the\ndatabackend."}),"\n",(0,s.jsx)(a.p,{children:"I.e., for MongoDB the following are equivalent:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"db = superduper('mongodb://localhost:27018/documents')\n"})}),"\n",(0,s.jsx)(a.p,{children:"...and"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"db = superduper(\n    'mongodb://localhost:27018/documents',\n    metadata_store='mongodb://localhost:27018/documents',\n    artifact_store='mongodb://localhost:27018/documents',\n)\n"})}),"\n",(0,s.jsx)(a.p,{children:"Whenever a database is supported by the artifact store and metadata store,\nthe same behaviour holds. However, since there is no general pattern\nfor storing large files in SQL databases, the fallback artifact store\nis on the local filesystem. So the following are equivalent:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"db = superduper('sqlite://<my-database>.db')\n"})}),"\n",(0,s.jsx)(a.p,{children:"...and"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-python",children:"db = superduper(\n    'sqlite://<my-database>.db',\n    metadata_store='sqlite://<my-database>.db',\n    artifact_store='filesystem://.superduperdb/artifacts/',\n)\n"})})]})}function h(e={}){const{wrapper:a}={...(0,t.a)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},11151:(e,a,n)=>{n.d(a,{Z:()=>o,a:()=>d});var s=n(67294);const t={},r=s.createContext(t);function d(e){const a=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),s.createElement(r.Provider,{value:a},e.children)}}}]);